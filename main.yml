- name: Update apt repo
  apt:
    update_cache: true

- name: Install dependencies
  apt:
    name:
      - python3
      - python3-pip
      - git
    state: present

- name: Clone repo
  git:
    repo: "https://github.com/pratikshyarout/Plant-Pest-and-Disease-Detection-Web-Application.git"
    dest: /home/ubuntu/plant-app

- name: Install requirements
  pip:
    requirements: /home/ubuntu/plant-app/backup/backend/requirements.txt

- name: Enable system service
  template:
    src: system.j2
    dest: /etc/systemd/system/flaskapp.service

- name: Restart service
  systemd:
    name: flaskapp
    enabled: true
    state: restarted
